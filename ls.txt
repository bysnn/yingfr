this is lib3 modified.
