this is lib3 modified.

===== ying2 master
