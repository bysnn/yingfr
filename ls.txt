this is lib3 modified.
yingfr pullmerge update
